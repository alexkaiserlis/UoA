{
  "config": {
    "model": {
      "model_name": "AI-team-UoA/GreekLegalRoBERTa_v2",
      "num_labels": 17,
      "use_crf": true,
      "hidden_dropout_prob": 0.1,
      "attention_dropout_prob": 0.1,
      "classifier_dropout": 0.1,
      "initializer_range": 0.02,
      "layer_norm_eps": 1e-12,
      "crf_reduction": "mean",
      "freeze_bert_layers": null,
      "gradient_checkpointing": false
    },
    "training": {
      "learning_rate": 5e-05,
      "weight_decay": 0.01,
      "adam_epsilon": 1e-08,
      "adam_beta1": 0.9,
      "adam_beta2": 0.999,
      "max_grad_norm": 1.0,
      "num_train_epochs": 6,
      "warmup_steps": 500,
      "warmup_ratio": 0.1,
      "per_device_train_batch_size": 8,
      "per_device_eval_batch_size": 16,
      "gradient_accumulation_steps": 1,
      "evaluation_strategy": "epoch",
      "eval_steps": null,
      "save_strategy": "epoch",
      "save_steps": null,
      "save_total_limit": 3,
      "load_best_model_at_end": true,
      "metric_for_best_model": "eval_overall_f1",
      "greater_is_better": true,
      "early_stopping_patience": 2,
      "early_stopping_threshold": 0.001,
      "logging_strategy": "steps",
      "logging_steps": 50,
      "report_to": [],
      "seed": 44,
      "data_seed": null,
      "fp16": true,
      "bf16": false,
      "dataloader_num_workers": 2,
      "dataloader_pin_memory": true
    },
    "data": {
      "dataset_name": "local_iob",
      "dataset_config": null,
      "max_length": 512,
      "stride": 50,
      "padding": "max_length",
      "truncation": true,
      "return_overflowing_tokens": true,
      "label_all_tokens": false,
      "ignore_label_id": -100,
      "compute_class_weights": true,
      "class_weight_method": "capped_sqrt_inv_freq",
      "enable_augmentation": false,
      "augmentation_multiplier": 3,
      "target_rare_classes": [
        "NATIONAL_LOCATION",
        "UNKNOWN_LOCATION",
        "FACILITY"
      ],
      "validation_split": 0.1,
      "test_split": 0.1,
      "shuffle_train": true,
      "cache_dir": null,
      "use_fast_tokenizer": true
    },
    "loss": {
      "loss_type": "standard_ce",
      "focal_alpha": 0.25,
      "focal_gamma": 1.0,
      "focal_reduction": "mean",
      "use_class_weights": false,
      "class_weight_method": "capped_sqrt_inv_freq",
      "loss_weights": {
        "main": 1.0,
        "auxiliary": 0.1
      }
    },
    "output": {
      "output_dir": "./experiments",
      "logging_dir": "./logs",
      "cache_dir": "./cache",
      "experiment_name": "crf_enhanced",
      "run_name": null,
      "save_model": true,
      "save_tokenizer": true,
      "save_results": true,
      "save_predictions": false,
      "result_formats": [
        "json",
        "csv"
      ]
    },
    "name": "crf_enhanced",
    "description": "ROBERTa with CRF for structured prediction",
    "tags": [
      "crf",
      "roberta",
      "structured_prediction"
    ],
    "num_runs": 1,
    "base_seed": null,
    "seed_increment": 1,
    "aggregate_results": true,
    "save_individual_models": true,
    "continue_on_failure": false
  },
  "training": {
    "training_loss": 1.9363273007733686,
    "global_step": 13320,
    "training_time": 10296.3483,
    "training_samples_per_second": 10.348,
    "best_model_info": {
      "best_model_checkpoint": "experiments\\crf_enhanced\\checkpoint-11100",
      "best_epoch": 5.0,
      "best_step": 11100,
      "best_metric": 0.7373715285370654,
      "training_history": [
        {
          "epoch": 1.0,
          "eval_loss": 2.642761468887329,
          "eval_overall_f1": 0.65620231087857,
          "eval_macro_f1": 0.588352157257498,
          "eval_micro_f1": 0.7382340973823409
        },
        {
          "epoch": 2.0,
          "eval_loss": 2.7105677127838135,
          "eval_overall_f1": 0.6943957968476357,
          "eval_macro_f1": 0.6445228208608024,
          "eval_micro_f1": 0.7593725073118851
        },
        {
          "epoch": 3.0,
          "eval_loss": 3.5851056575775146,
          "eval_overall_f1": 0.7252353204840879,
          "eval_macro_f1": 0.6302665245601347,
          "eval_micro_f1": 0.7646532130312005
        },
        {
          "epoch": 4.0,
          "eval_loss": 3.8429324626922607,
          "eval_overall_f1": 0.7368421052631579,
          "eval_macro_f1": 0.6668050916104468,
          "eval_micro_f1": 0.780633196449861
        },
        {
          "epoch": 5.0,
          "eval_loss": 4.239257335662842,
          "eval_overall_f1": 0.7373715285370654,
          "eval_macro_f1": 0.6643343713452842,
          "eval_micro_f1": 0.7813977929584865
        },
        {
          "epoch": 6.0,
          "eval_loss": 4.498525619506836,
          "eval_overall_f1": 0.7368884971353019,
          "eval_macro_f1": 0.5827540128233228,
          "eval_micro_f1": 0.7798542080848242
        }
      ],
      "best_epoch_from_history": 5.0,
      "best_f1_from_history": 0.7373715285370654
    }
  },
  "evaluation": {
    "eval_loss": 4.796239852905273,
    "eval_overall_f1": 0.7168181818181819,
    "eval_overall_precision": 0.6871459694989107,
    "eval_overall_recall": 0.7491686460807601,
    "eval_macro_f1": 0.5760284627956572,
    "eval_micro_f1": 0.7548021005885877,
    "eval_tag_accuracy": 0.9750821661924541,
    "eval_total_entities_true": 4210,
    "eval_total_entities_pred": 4590,
    "eval_invalid_sequences": 205,
    "eval_orphaned_i_tags": 561,
    "eval_FACILITY_f1": 0.368421052631579,
    "eval_FACILITY_precision": 0.358974358974359,
    "eval_FACILITY_recall": 0.3783783783783784,
    "eval_FACILITY_support": 111,
    "eval_B-FACILITY_true_count": 111,
    "eval_B-FACILITY_pred_count": 100,
    "eval_B-FACILITY_correct_count": 48,
    "eval_B-FACILITY_accuracy": 0.43243243243243246,
    "eval_I-FACILITY_true_count": 343,
    "eval_I-FACILITY_pred_count": 221,
    "eval_I-FACILITY_correct_count": 96,
    "eval_I-FACILITY_accuracy": 0.27988338192419826,
    "eval_GPE_f1": 0.7922960725075529,
    "eval_GPE_precision": 0.7857677902621722,
    "eval_GPE_recall": 0.7989337395277989,
    "eval_GPE_support": 1313,
    "eval_B-GPE_true_count": 1313,
    "eval_B-GPE_pred_count": 1272,
    "eval_B-GPE_correct_count": 1052,
    "eval_B-GPE_accuracy": 0.8012185833968012,
    "eval_I-GPE_true_count": 2547,
    "eval_I-GPE_pred_count": 2911,
    "eval_I-GPE_correct_count": 2384,
    "eval_I-GPE_accuracy": 0.9360031409501374,
    "eval_LEG-REFS_f1": 0.802647412755716,
    "eval_LEG-REFS_precision": 0.8254950495049505,
    "eval_LEG-REFS_recall": 0.7810304449648712,
    "eval_LEG-REFS_support": 854,
    "eval_B-LEG-REFS_true_count": 854,
    "eval_B-LEG-REFS_pred_count": 763,
    "eval_B-LEG-REFS_correct_count": 680,
    "eval_B-LEG-REFS_accuracy": 0.7962529274004684,
    "eval_I-LEG-REFS_true_count": 1795,
    "eval_I-LEG-REFS_pred_count": 1516,
    "eval_I-LEG-REFS_correct_count": 1192,
    "eval_I-LEG-REFS_accuracy": 0.664066852367688,
    "eval_LOCATION-NAT_f1": 0.0,
    "eval_LOCATION-NAT_precision": 0.0,
    "eval_LOCATION-NAT_recall": 0.0,
    "eval_LOCATION-NAT_support": 7,
    "eval_B-LOCATION-NAT_true_count": 7,
    "eval_B-LOCATION-NAT_pred_count": 1,
    "eval_B-LOCATION-NAT_correct_count": 0,
    "eval_B-LOCATION-NAT_accuracy": 0.0,
    "eval_I-LOCATION-NAT_true_count": 16,
    "eval_I-LOCATION-NAT_pred_count": 1,
    "eval_I-LOCATION-NAT_correct_count": 0,
    "eval_I-LOCATION-NAT_accuracy": 0.0,
    "eval_LOCATION-UNK_f1": 0.4033613445378152,
    "eval_LOCATION-UNK_precision": 0.47058823529411764,
    "eval_LOCATION-UNK_recall": 0.35294117647058826,
    "eval_LOCATION-UNK_support": 68,
    "eval_B-LOCATION-UNK_true_count": 68,
    "eval_B-LOCATION-UNK_pred_count": 49,
    "eval_B-LOCATION-UNK_correct_count": 27,
    "eval_B-LOCATION-UNK_accuracy": 0.39705882352941174,
    "eval_I-LOCATION-UNK_true_count": 143,
    "eval_I-LOCATION-UNK_pred_count": 79,
    "eval_I-LOCATION-UNK_correct_count": 49,
    "eval_I-LOCATION-UNK_accuracy": 0.34265734265734266,
    "eval_ORG_f1": 0.6534047436878347,
    "eval_ORG_precision": 0.5881542699724518,
    "eval_ORG_recall": 0.7349397590361446,
    "eval_ORG_support": 1162,
    "eval_B-ORG_true_count": 1162,
    "eval_B-ORG_pred_count": 1396,
    "eval_B-ORG_correct_count": 907,
    "eval_B-ORG_accuracy": 0.7805507745266781,
    "eval_I-ORG_true_count": 3649,
    "eval_I-ORG_pred_count": 3794,
    "eval_I-ORG_correct_count": 2744,
    "eval_I-ORG_accuracy": 0.7519868457111537,
    "eval_PERSON_f1": 0.7440414507772022,
    "eval_PERSON_precision": 0.6851145038167938,
    "eval_PERSON_recall": 0.8140589569160998,
    "eval_PERSON_support": 441,
    "eval_B-PERSON_true_count": 441,
    "eval_B-PERSON_pred_count": 505,
    "eval_B-PERSON_correct_count": 368,
    "eval_B-PERSON_accuracy": 0.8344671201814059,
    "eval_I-PERSON_true_count": 473,
    "eval_I-PERSON_pred_count": 578,
    "eval_I-PERSON_correct_count": 424,
    "eval_I-PERSON_accuracy": 0.8964059196617337,
    "eval_PUBLIC-DOCS_f1": 0.5719424460431656,
    "eval_PUBLIC-DOCS_precision": 0.5264900662251656,
    "eval_PUBLIC-DOCS_recall": 0.6259842519685039,
    "eval_PUBLIC-DOCS_support": 254,
    "eval_B-PUBLIC-DOCS_true_count": 254,
    "eval_B-PUBLIC-DOCS_pred_count": 281,
    "eval_B-PUBLIC-DOCS_correct_count": 175,
    "eval_B-PUBLIC-DOCS_accuracy": 0.6889763779527559,
    "eval_I-PUBLIC-DOCS_true_count": 880,
    "eval_I-PUBLIC-DOCS_pred_count": 850,
    "eval_I-PUBLIC-DOCS_correct_count": 562,
    "eval_I-PUBLIC-DOCS_accuracy": 0.6386363636363637,
    "eval_transition_variance": 0.0043136561289429665,
    "eval_transition_range": 0.36358964443206787,
    "eval_crf_enabled": true,
    "eval_sequence_coherence": 0.9998733603225635,
    "eval_runtime": 281.3335,
    "eval_samples_per_second": 31.866,
    "eval_steps_per_second": 1.994,
    "epoch": 6.0
  },
  "detailed_metrics": {
    "overall_f1": 0.7168181818181819,
    "overall_precision": 0.6871459694989107,
    "overall_recall": 0.7491686460807601,
    "macro_f1": 0.5760284627956572,
    "micro_f1": 0.7548021005885877,
    "tag_accuracy": 0.9750821661924541,
    "total_entities_true": 4210,
    "total_entities_pred": 4590,
    "invalid_sequences": 205,
    "orphaned_i_tags": 561,
    "FACILITY_f1": 0.368421052631579,
    "FACILITY_precision": 0.358974358974359,
    "FACILITY_recall": 0.3783783783783784,
    "FACILITY_support": 111,
    "B-FACILITY_true_count": 111,
    "B-FACILITY_pred_count": 100,
    "B-FACILITY_correct_count": 48,
    "B-FACILITY_accuracy": 0.43243243243243246,
    "I-FACILITY_true_count": 343,
    "I-FACILITY_pred_count": 221,
    "I-FACILITY_correct_count": 96,
    "I-FACILITY_accuracy": 0.27988338192419826,
    "GPE_f1": 0.7922960725075529,
    "GPE_precision": 0.7857677902621722,
    "GPE_recall": 0.7989337395277989,
    "GPE_support": 1313,
    "B-GPE_true_count": 1313,
    "B-GPE_pred_count": 1272,
    "B-GPE_correct_count": 1052,
    "B-GPE_accuracy": 0.8012185833968012,
    "I-GPE_true_count": 2547,
    "I-GPE_pred_count": 2911,
    "I-GPE_correct_count": 2384,
    "I-GPE_accuracy": 0.9360031409501374,
    "LEG-REFS_f1": 0.802647412755716,
    "LEG-REFS_precision": 0.8254950495049505,
    "LEG-REFS_recall": 0.7810304449648712,
    "LEG-REFS_support": 854,
    "B-LEG-REFS_true_count": 854,
    "B-LEG-REFS_pred_count": 763,
    "B-LEG-REFS_correct_count": 680,
    "B-LEG-REFS_accuracy": 0.7962529274004684,
    "I-LEG-REFS_true_count": 1795,
    "I-LEG-REFS_pred_count": 1516,
    "I-LEG-REFS_correct_count": 1192,
    "I-LEG-REFS_accuracy": 0.664066852367688,
    "LOCATION-NAT_f1": 0.0,
    "LOCATION-NAT_precision": 0.0,
    "LOCATION-NAT_recall": 0.0,
    "LOCATION-NAT_support": 7,
    "B-LOCATION-NAT_true_count": 7,
    "B-LOCATION-NAT_pred_count": 1,
    "B-LOCATION-NAT_correct_count": 0,
    "B-LOCATION-NAT_accuracy": 0.0,
    "I-LOCATION-NAT_true_count": 16,
    "I-LOCATION-NAT_pred_count": 1,
    "I-LOCATION-NAT_correct_count": 0,
    "I-LOCATION-NAT_accuracy": 0.0,
    "LOCATION-UNK_f1": 0.4033613445378152,
    "LOCATION-UNK_precision": 0.47058823529411764,
    "LOCATION-UNK_recall": 0.35294117647058826,
    "LOCATION-UNK_support": 68,
    "B-LOCATION-UNK_true_count": 68,
    "B-LOCATION-UNK_pred_count": 49,
    "B-LOCATION-UNK_correct_count": 27,
    "B-LOCATION-UNK_accuracy": 0.39705882352941174,
    "I-LOCATION-UNK_true_count": 143,
    "I-LOCATION-UNK_pred_count": 79,
    "I-LOCATION-UNK_correct_count": 49,
    "I-LOCATION-UNK_accuracy": 0.34265734265734266,
    "ORG_f1": 0.6534047436878347,
    "ORG_precision": 0.5881542699724518,
    "ORG_recall": 0.7349397590361446,
    "ORG_support": 1162,
    "B-ORG_true_count": 1162,
    "B-ORG_pred_count": 1396,
    "B-ORG_correct_count": 907,
    "B-ORG_accuracy": 0.7805507745266781,
    "I-ORG_true_count": 3649,
    "I-ORG_pred_count": 3794,
    "I-ORG_correct_count": 2744,
    "I-ORG_accuracy": 0.7519868457111537,
    "PERSON_f1": 0.7440414507772022,
    "PERSON_precision": 0.6851145038167938,
    "PERSON_recall": 0.8140589569160998,
    "PERSON_support": 441,
    "B-PERSON_true_count": 441,
    "B-PERSON_pred_count": 505,
    "B-PERSON_correct_count": 368,
    "B-PERSON_accuracy": 0.8344671201814059,
    "I-PERSON_true_count": 473,
    "I-PERSON_pred_count": 578,
    "I-PERSON_correct_count": 424,
    "I-PERSON_accuracy": 0.8964059196617337,
    "PUBLIC-DOCS_f1": 0.5719424460431656,
    "PUBLIC-DOCS_precision": 0.5264900662251656,
    "PUBLIC-DOCS_recall": 0.6259842519685039,
    "PUBLIC-DOCS_support": 254,
    "B-PUBLIC-DOCS_true_count": 254,
    "B-PUBLIC-DOCS_pred_count": 281,
    "B-PUBLIC-DOCS_correct_count": 175,
    "B-PUBLIC-DOCS_accuracy": 0.6889763779527559,
    "I-PUBLIC-DOCS_true_count": 880,
    "I-PUBLIC-DOCS_pred_count": 850,
    "I-PUBLIC-DOCS_correct_count": 562,
    "I-PUBLIC-DOCS_accuracy": 0.6386363636363637,
    "transition_variance": 0.0043136561289429665,
    "transition_range": 0.36358964443206787,
    "crf_enabled": true,
    "sequence_coherence": 0.9998733603225635
  },
  "timestamp": "2025-08-05T22:56:44.800262"
}